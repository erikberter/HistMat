{% extends 'base.html' %}
{% load i18n %}

{% block title%} Home | HistMat  {% endblock%}

{% block js %}
{% load static %}
    <script src="{% static 'js/home.js'%}"></script>
{% endblock %}

{% block content %}

<div class="container">
    {% if important_blog %}
    <div id="carouselExampleIndicators" class="carousel slide carousel-fade mt-3 shadow-sm w-100" data-ride="carousel">
        <ol class="carousel-indicators">
            {% for blog in important_blog %}
                <li data-target="#carouselExampleIndicators" data-slide-to="{{forloop.counter0}}" {% if forloop.counter0 == 0%}class="active" {% endif %}></li>
            {% endfor %}
        </ol>
        <div class="carousel-inner">
            {% for blog in important_blog%}
            <div class="carousel-item {% if forloop.counter0 == 0%}active {% endif %}">
                <img class="d-block jumbo" src="{{blog.thumbnail.url}}" alt="First slide">
                <div class="carousel-caption d-none d-md-block">
                    <h3 class="text-white">{{blog.title}}</h3>
                    <p class="text-white">{{blog.text|truncatechars:300|safe}}</p>
                    <a class="btn btn-primary" href="{{blog.get_absolute_url}}">{% trans "Leer Noticia" %}</a>
                </div>
            </div>
            {% endfor %}
        </div>
        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
      </div>
      
      {% endif %}
      
    <div class="my-4">
        <div class="row">
            <div class="col-md-8">
                <div class="rounded p-2 bg-primary shadow-sm">
                    <div class="d-flex justify-content-center">
                        <h1 class="text-white">
                            <strong>
                                Feed de amigos
                            </strong>
                        </h1>
                    </div>
                </div>
                <div class="rounded justify-content-center">
                    <div class="d-flex flex-column w-100">
                        {% for action in action_list %}
                            <div class="home_action card w-100 my-2 shadow-sm" style="display: none;">
                                <div class="pt-3 px-3"><small>{{action.timestamp}}:</small></div>
                                <div class="d-flex flex-row px-4 pb-2 pt-0">
                                    {% if action.autor.profile_image_t11 %}
                                        <img class="rounded" src="{{ action.autor.profile_image_t11.url }}" width="100" height="100" alt="{{ action.autor.username }} profile pic" />
                                    {% endif %}
                                    <div class="card-body p-2 pt-3"><h5>{{action.text|safe}}</h5></div>
                                    
                                </div>
                            </div>
                        {% empty %}
                            <div class="home_action card w-100 my-2 shadow-sm" style="display: none;">
                                <div class="d-flex justify-content-center">
                                    <h3 class="p-2">No hay cambios en la lista</h3>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <div class="col-md-4 pull-right">
                <div class="rounded bg-white shadow-sm">
                    <div class="rounded-top d-flex justify-content-center bg-primary p-2">
                        <h3 class="text-white">
                            <strong>
                                {% trans 'Usuario'%}
                            </strong>
                        </h3>
                    </div>
                    <div class="container">
                        <div class="row p-3">
                            <div class="col-xl-4 d-flex justify-content-center">
                                {% if user.profile_image_t11 %}
                                    <img class="rounded img-fluid" src="{{ user.profile_image_t11.url }}" width="100" height="100" alt="{{ action.autor.username }} profile pic"/>
                                {% else %}
                                    {% load static %}
                                    <img class="rounded img-fluid" src="{% static 'img/no_profile_img.jpg'%}" width="100" height="100" alt="{{ action.autor.username }} profile pic"/>
                                {% endif %}
                            </div>
                            <div class="p-1 col-xl-8">
                                <div class="d-flex flex-column">
                                    <span>{% trans 'Usuario'%}: {{user.username}}</span>
                                    <span>{% trans 'Nivel' %}: {{user.level}}</span>
                                    <span>{% trans 'Categoria' %}: {{user.kind_of_user}}</span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col p-3">
                                <div class="progress mb-3 w-100">
                                    <div class="progress-bar bg-success progress-bar-striped progress-bar-animated" style="width:{{user.get_level_progress}}%"></div>
                                </div>
                            </div>     
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div> 
</div>
{% endblock %}